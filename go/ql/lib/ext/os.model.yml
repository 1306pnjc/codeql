extensions:
  - addsTo:
      pack: codeql/go-all
      extensible: sinkModel
    data:
      # path-injection
      - ["os", "", True, "Chdir", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Chmod", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Chown", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Chtimes", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Create", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Lchown", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Link", "", "", "Argument[0..1]", "path-injection", "manual"]
      - ["os", "", True, "Lstat", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Mkdir", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "MkdirAll", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "NewFile", "", "", "Argument[1]", "path-injection", "manual"]
      - ["os", "", True, "Open", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "OpenFile", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Readlink", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Remove", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "RemoveAll", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Rename", "", "", "Argument[0..1]", "path-injection", "manual"]
      - ["os", "", True, "Stat", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "Symlink", "", "", "Argument[0..1]", "path-injection", "manual"]
      - ["os", "", True, "Truncate", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "DirFS", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "ReadDir", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "ReadFile", "", "", "Argument[0]", "path-injection", "manual"]
      - ["os", "", True, "MkdirTemp", "", "", "Argument[0..1]", "path-injection", "manual"]
      - ["os", "", True, "CreateTemp", "", "", "Argument[0..1]", "path-injection", "manual"]
      - ["os", "", True, "WriteFile", "", "", "Argument[0]", "path-injection", "manual"]
      # command-injection
      - ["os", "", True, "StartProcess", "", "", "Argument[0]", "command-injection", "manual"]
  - addsTo:
      pack: codeql/go-all
      extensible: summaryModel
    data:
      - ["os", "", True, "Expand", "", "", "Argument[0]", "ReturnValue", "taint", "manual"]
      - ["os", "", True, "ExpandEnv", "", "", "Argument[0]", "ReturnValue", "taint", "manual"]
      - ["os", "", True, "NewFile", "", "", "Argument[0]", "ReturnValue", "taint", "manual"]
      - ["os", "File", True, "Fd", "", "", "Argument[receiver]", "ReturnValue", "taint", "manual"]
      - ["os", "File", True, "Read", "", "", "Argument[receiver]", "Argument[0]", "taint", "manual"]
      - ["os", "File", True, "ReadAt", "", "", "Argument[receiver]", "Argument[0]", "taint", "manual"]
  - addsTo:
      pack: codeql/go-all
      extensible: sourceModel
    data:
      - ["os", "", True, "Environ", "", "", "ReturnValue", "environment", "manual"] # TODO: when sources can have access paths, use .ArrayElement
      - ["os", "", True, "ExpandEnv", "", "", "ReturnValue", "environment", "manual"]
      - ["os", "", True, "Getenv", "", "", "ReturnValue", "environment", "manual"]
      - ["os", "", True, "LookupEnv", "", "", "ReturnValue[0]", "environment", "manual"]
      - ["os", "", True, "Open", "", "", "ReturnValue[0]", "file", "manual"]
      - ["os", "", True, "OpenFile", "", "", "ReturnValue[0]", "file", "manual"]
      - ["os", "", True, "ReadFile", "", "", "ReturnValue[0]", "file", "manual"]
      - ["os", "", True, "UserCacheDir", "", "", "ReturnValue[0]", "environment", "manual"]
      - ["os", "", True, "UserConfigDir", "", "", "ReturnValue[0]", "environment", "manual"]
      - ["os", "", True, "UserHomeDir", "", "", "ReturnValue[0]", "environment", "manual"]
