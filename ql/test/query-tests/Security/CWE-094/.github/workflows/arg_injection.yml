name: Argument injection

on:
  issues:
    types: [opened, edited]

jobs:
  test1:
    runs-on: ubuntu-latest
    env:
      TITLE: ${{github.event.issue.title}}
    steps:
      - run: echo "s/FOO/$TITLE/g"
      - run: sed "s/FOO/$TITLE/g"
      - run: echo "foo" | sed "s/FOO/$TITLE/g" > bar
      - run: echo $(echo "foo" | sed "s/FOO/$TITLE/g" > bar)
      - run: awk "BEGIN {$TITLE}"
      - run: sed -i "s/git_branch = .*/git_branch = \"$GITHUB_HEAD_REF\"/" config.json
      - run: |
          sed -i "s|git_branch = .*|git_branch = \"$GITHUB_HEAD_REF\"|" config.json
      - run: |
          sed -e 's#<branch_to_sync>#${TITLE}#' \
              -e 's#<sot_repo>#${{ env.sot_repo }}#' \
              -e 's#<destination_repo>#TITLE#' \
              .github/workflows/common-copybara.bara.sky.template > .github/workflows/common-copybara.bara.sky
      - run: |
          sed -e 's#<branch_to_sync>#TITLE#' \
              -e 's#<sot_repo>#${{ env.sot_repo }}#' \
              -e 's#<destination_repo>#${TITLE}#' \
              .github/workflows/common-copybara.bara.sky.template > .github/workflows/common-copybara.bara.sky
