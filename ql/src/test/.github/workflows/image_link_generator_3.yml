name: Image URL Processing

on:
  issue_comment:
    types: [created]

jobs:
  process-image-url:
    runs-on: ubuntu-latest
    if: contains(github.event.comment.body, 'https://github.com/github/release-assets/assets/')
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Extract and Clean Initial URL
        id: source
        env:
          BODY: ${{ github.event.comment.body }}
        run: |
          INITIAL_URL=$(echo "$BODY" | grep -o 'https://github.com/github/release-assets/assets/[^ >]*')
          echo "Cleaned Initial URL: $INITIAL_URL"
          echo "::set-output name=initial_url::$INITIAL_URL"

      - name: Get Redirected URL with Debugging
        id: sink
        run: |
          echo ${{ steps.source.outputs.initial_url }}
