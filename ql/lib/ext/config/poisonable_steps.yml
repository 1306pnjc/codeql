extensions:
  - addsTo:
      pack: github/actions-all
      extensible: poisonableActionsDataModel
    # source: https://github.com/boostsecurityio/poutine/blob/main/opa/rego/rules/untrusted_checkout_exec.rego#L16
    # source: https://boostsecurityio.github.io/lotp/
    data:
      - ["pre-commit/action"]
      - ["oxsecurity/megalinter"]
      - ["bridgecrewio/checkov-action"]
      - ["ruby/setup-ruby"]
      - ["actions/jekyll-build-pages"]
      - ["qcastel/github-actions-maven/actions/maven"]
  - addsTo:
      pack: github/actions-all
      extensible: poisonableCommandsDataModel
    # source: https://github.com/boostsecurityio/poutine/blob/main/opa/rego/rules/untrusted_checkout_exec.rego#L23
    # source: https://boostsecurityio.github.io/lotp/
    data:
      - ["ant "]
      - ["bundle "]
      - ["cargo "]
      - ["checkov "]
      - ["eslint "]
      - ["go generate"]
      - ["go run"]
      - ["gomplate "]
      - ["gradle "]
      - ["java -jar"]
      - ["make "]
      - ["mkdocs"]
      - ["msbuild"]
      - ["mvn"]
      - ["mypy"]
      - ["npm i(nstall)?"]
      - ["npm run"]
      - ["npm ci"]
      - ["pre-commit"]
      - ["prettier"]
      - ["pip install -r"]
      - ["pip install --requirement"]
      - ["poetry"]
      - ["pylint"]
      - ["pytest"]
      - ["rake "]
      - ["rails db:create"]
      - ["rails assets:precompile"]
      - ["rubocop "]
      - ["terraform "]
      - ["tflint"]
      - ["yarn "]
  - addsTo:
      pack: github/actions-all
      extensible: poisonableLocalScriptsDataModel
    data:
      # TODO: It could also be in the form of `dir/cmd`
      - ["(^|;\\s*|\\s+)(\\.\\/)(.*)(\\s+|;|$)", 3]
      - ["(^|;\\s*|\\s+)(source|sh|bash|zsh|fish)\\s+(.*)(\\s+|;|$)", 3]
      - ["(^|;\\s*|\\s+)(node)\\s+(.*)(\\.js|\\.ts)(\\s+|;|$)", 3]
      - ["(^|;\\s*|\\s+)(python)\\s+(.*)\\.py(\\s+|;|$)", 3]
      - ["(^|;\\s*|\\s+)(ruby)\\s+(.*)\\.rb(\\s+|;|$)", 3]
      - ["(^|;\\s*|\\s+)(go)\\s+(.*)\\.go(\\s+|;|$)", 3]

